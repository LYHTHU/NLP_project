%
% File acl2015.tex
%%
%% Based on the style files for ACL-2014, which were, in turn,

%% and that of ACL 08 by Joakim Nivre and Noah Smith

\documentclass[11pt]{article}
\usepackage{acl2015}
\usepackage{times}
\usepackage{url}
\usepackage{latexsym}
\usepackage[colorlinks,linkcolor=blue]{hyperref}
% \usepackage{cite}

% \setlength\titlebox{5cm}

% You can expand the titlebox if you need extra space
% to show all the authors. Please do not make the titlebox
% smaller than 5cm (the original size); we will check this
% in the camera-ready version and ask you to change it back.


\title{Text mining on Novels}

\author{Xiangyu Wei \\
  CIMS \\
  New York University \\
  {\tt xw1882@nyu.edu} \\\And
  Yunhao Li \\ 
  CIMS \\
  New York University \\
  {\tt yl6220@nyu.edu} \\\And
  Kaili Ding \\ 
  CIMS \\
  New York University \\
  {\tt kd2164@nyu.edu} \\}

% \date{}

\begin{document}
\maketitle
\begin{abstract} % Yunhao Li
  We develop a system that can automatically mining the data of novels. The system includes name entity recognition and merging, coreference resolution, interaction and sentiment analysis and relation extraction. Finally, we test it on two novels and visualize the result, which shows that our system runs well.
\end{abstract}

\section{Introduction} % Yunhao Li

The information extraction is an interesting field in Natural Language Processing(NLP). And text mining is an information extraction process for deriving high-quality information from text. As one of the most popular genres of literature, novel always have a lot of information between roles. Remembering all the roles and their relationships is somewhat hard for readers. A system that can help the readers understand the novel will be great. \\

In this paper we aims at mining the sentiment and social relationships between roles of the novels. To detect all the roles showing up in the novel, we need to do name entity recognition. Considering that every roles may have several names in one novel(e.g. Ronald Weasley, aka Ron, Ron Weasley, Mr.Weasley), we need to find a way to merge these alias and point them to the correlated role. This part will be introduced in part 3.1. \\

Coreference resolution is also essential. A role in the novel may always occur with a pronoun instead of his/her real name (or alias). If we just do the search with their names, we are not able to find enough information. Part 3.2 will explain how we do coreference resolution in detail.  \\

Part 3.3 introduces the text processing to get a sentences list where all pronoun replaced by the most possible correlated name, which will be replaced by its formatted name later.  \\

Having the pre-processed sentences list, we will do interaction and sentiment analysis. We get a interact matrix by analyzing each sentence. And we use two different methods to get the sentiment polarity scores of the sentence. We also build the sentiment matrices to do some analysis, including clustering analysis(using scikit-learn~\cite{sklearn_api}). Part 3.4 will provide the explanation. \\

% TODO: cite
In relation extraction part, we implement a method combining the algorithms introduced by 
[cite paper] and [cite paper]. It works very well on the novels. We can extract a clear social relation(parent, children, siblings, etc). And we visualize the results. The details are in part 3.5 and Experiments. \\

% TODO: cite
We do the tests on two novels, \textit{Harry Potter and the Sorcerer's Stone} and \textit{Pride and Prejudice}. The details of the results are shown in Experiment part.

% cite
\section{Related work} % Yunhao Li
Text mining on novels is an integral project instead of a single target. So we search the related work in different fields of NLP.\\

In the name entity recognition(NER), there is lots of libraries provide NER API for developers to use, such as CoreNLP~\cite{corenlp}, NLTK~\cite{Loper02nltk:the}, Spacy~\cite{honnibal-johnson:2015:EMNLP}, etc. They provide a good result of NER.\\

For the sentiment analysis, there is a lot of libraries and APIs provided by research institute or companies. Companies like Facebook, Google, Baidu, Tencent, etc, provide API 
for sentiment analysis. However, the Google's API is not free, which means unusable for us. The APIs of Baidu and Tencent only work well on Chinese texts. When testing on English text it doesn't perform well. We finally find nltk.sentiment.vader~\cite{Vader} works well on sentiment analysis. \\

Coreference resolution is an important field in NLP. The models of Clark and Manning~\cite{clark-manning-2016-deep}, based on Deep Learning, works well in our project. \\

We also find several papers works well in relation extraction. For extacting the family relation and social relation, Makazhanov's work~\cite{Makazhanov2014ExtractingFR} gives us a good point. And Kokkinakis and Malm~\cite{kokkinakis-malm-2011-character} also shows a way to extract relationship in Novel.


\section{Approaches}
It is a integral system that works on processing the novel in our work. It can be split into several parts introduced in the following sections.

\subsection{Role entity recognition and merging} % Kaili Ding

The very first step of the whole pipeline is to extract names of roles in the novel and merge the alias of one role as accurate as possible so that we can prevent multiple roles presenting one role in our final results. The merging step can make our results more accurate. \\

To extract names, we use name entity extractor in StanfordNLP library, which tags names with ``PERSON" tag. We run the extractor on the novels, and consider continuous words tagged with ``PERSON" as a name. For the novel Harry Potter, after the raw extraction, we have 228 names. \\

Clearly, there are too many names for us to generate a clear relationship among roles. Therefore, we decide to reduce names we have extracted. By manually looking into the names we extracted, we find that for some roles, there are many alias for them. Essentially, these alias can be classified into three types. The first type is alias from typo. For example, we have ``Quirrell" and ``Quirtell", which are obviously aliases of the same entity. The second type is alias of part of names. For example, we have both ``Harry" and ``Harry Potter" in our novel. In this case, we need find a way to merge them, otherwise, we will have both ``Harry" and ``Harry Potter" in our final results as noise. The final type is alias of nicknames of the same entity, such as ``Nicolas" and ``Nick", and ``Johnson" and ``Johnny". \\

To deal with the typo alias, we can take advantage of the characteristics that the typo is only about one or at most two characters in a word, and most of the characters and their order are correct even there is a typo. We need to introduce a measure of similarity between words. We used both Soundex system and Jaro distance. The Soundex system~\cite{Soundex} is to assign a code to a word based on a set of pronunciation rule. The code consist of a letter, which is the first letter of the word, and three digits. The basic idea behind this system is we ignore vowel characters and group some consonant characters that have similar pronunciation and assign them a single digit. We stop once we get three digits on this word, or append 0 if the word cannot generate three digits. In our case, we regard two words as the same if they have the same Soundex code. The Jaro distance~\cite{Jaro} is a measure on the strings themselves. Basically, we calculate the number of matching characters in two words, and then further the proportion of matching characters in both strings. The order of matching characters should be the same, but we allow some transposition of characters whose distance is smaller than certain value in original words. The measure will generate a value between 0 and 1, and the larger the value is, the more similar the two words are. Applying both methods, we find that although Soundex system provides fewer aliases (merges more aliases), it mistakenly merges some aliases. Thus, we decide to use Jaro distance to merge aliases at last. \\

To tackle aliases from part of names, we split two names by space and check whether one name contain the other. The contain here is defined as one name has all the same words in the other name in the same order. Considering the existence of typo, we use Jaro distance again when we compare two words. If one name is contained by only one other name, then we merge the contained name into the name contains it. \\

For the alias of nickname, we haven't find a good way to merge them, since their pronunciation is different and similarity is low. One possible way to deal with this situation is have a dictionary of original name and nickname. However, the drawback of this solution is that the relationship among original name and nickname may not be one to one. \\

Furthermore, we add other features on extraction. We keep the prefix (Mr. and Mrs.) when extracting names as an indication of the gender. There are many roles who just appear several times in a novel, and we decide to drop them by setting a threshold to make the relationship map clearer. We also distinguish the family names and prevent merging them into other names. If we don't apply this rule, ``Weasleys" will be merged into ``Ron Weasley", which is not accurate. Finally, we assign a formatted name to each group after we do the merge. We will replace aliases and pronouns in the novel with the formatted names later.

\subsection{Coreference resolution} % Xiangyu Wei
\label{sect:pdf}

When the names of roles have been extracted, we need to find out in which scenarios these characters appear in the novel. Considering most of the characters are mentioned in a novel as pronouns like ``she", ``he" or ``they", it is important to match these pronouns with the names we have extracted. That is, we need do reference resolution for the text in the novel.

First, we tried the traditional rule-based method to do reference resolution for a text. We simply go through the text and do name-entity recognition using \textbf{Spacy package in Python}. When meeting a pronoun whose reference is unknown, we just search in previous sentences and use the first entity labelled "PERSON" which can match the pronoun in gender and number. To predict the gender of a given name, we used \textbf{Clint Valentine's gender-predictor Python package}. Considering we need to do a search for almost every pronouns like ``he", ``she" or ``they", the depth of each search can not be too large. Otherwise, the time cost of the program will be unaffordable for us. When doing reference resolution for \textit{Harry Potter and the Sorcerer's Stone}, we use the maximum search depth of 3 previous sentences.

In a novel, there are always some intricate plots in which two expressions referring to the same person are quite far from each other. When there are more than 3 sentences between a pronoun and its reference, our rule-based method will not give a correct match for that pronoun. To deal with such cases, we use the mention-ranking coreference model\textbf{ described by Kevin Clark and Christopher D. Manning, EMNLP 2016.} That model can give a score to every pairs of mentions indicating their compatibility for coreference, even the distence between two mentions is quite large. We use the model provided by \textbf{a spaCy toolkit NeuralCoref}. It provided better coreference result on intricate plots than the rule-based method. In the final result, we used the mention-ranking coreference model to analyze most of the texts in a novel, and used the rule-based method to modify some obvious mistakes.


\subsection{Text processing} % Yunhao Li
\label{ssec:layout}

After the previous processing, we now have a text where all the occurring pronouns replaced by a most likely name, and a name dictionary that maps all the alias of the same role to a single formatted name. Now we replaced all the names with its formatted name. Considering the situation that one name could be a sub-string of other names or words, we use a very simple but effective trick to solve this problem. \\
First, we create a dictionary, where the keys are the alias(i.e, names occur in the novel) and the correlated values are the formatted names. Then we sorted the item of the dictionary by the length of key in descending order. Then for each line in the text, we iterate the dictionary in order and replace the word that matches the key with its value. In particular, we avoid replacing the sequences occurring as part of a word but also matching a key(e.g, "Ted", may match "created", "Don" may match "Don't", etc). We make a simple rule: we only replace the matching sequences that are not followed by an letter and not start with a double quote("), which works very well. \\ 

Then we are going to split the text into sentences. We use NLTK and coreNLP to do this work. The list of sentences will be useful in the following sentiment analysis and relation extraction part.

\subsection{The analysis of interaction and sentiment between roles} % Yunhao Li
Given the sentences lists, the first thing needed is to find the sentences of interests. We want the sentences where occurs more than one roles. Using name dictionary we extract the sentences of interest and gather them together. \\

Then we are going to create interaction sentences. For each sentence in this list, we will calculate the interact matrix. We give each role a unique number as its index in the matrix. If two roles $(i, j)$ occur in the same sentence, we update the matrix $interact$ as $interact[i, j] += 1; interact[j, i] += 1$. Afterwards we get the $interact$ matrix which count how many times two roles interact each other. We visualize this result in the experiments.\\

%TODO: cite
We also create the sentiment matrix in the above procedure. For each pair of roles $(i, j)$
in the sentence, using \textbf{SentimentIntensityAnalyzer} of \textbf{NLTK} we calculate the sentiment polarity score of this sentence and get two score: $pos$ and $neg$. We use 2 different method to get the polarity score:
\begin{enumerate}
    \item Calculate the sentiment polarity of the whole sentences.
    \item Using dependency tree analyze the sentence, get the root word and compute the score of this word.
\end{enumerate}
We created several sentiment matrix based on these scores.
\begin{enumerate}
    \item $interact\_pos\_mat$: the entry $[i, j]$ is the sum of the pos score between role $(i, j)$
    \item $interact\_pos\_mat\_mean$: the entry $[i, j]$ is the mean value of the pos score between role $(i, j)$
    \item $interact\_neg\_mat$: the entry $[i, j]$ is the sum of the neg score between role $(i, j)$
    \item $interact\_neg\_mat\_mean$: the entry $[i, j]$ is the mean value of the neg score between role $(i, j)$
    \item $senti\_relationship$: $interact\_pos\_mat - interact\_neg\_mat$
\end{enumerate}

%TODO: cite
We want to mine some information out of these matrix. For a sentiment graph(matrix), there ought to exist several equivalent classes, each of which is a sub-graph. The relations inside a sub-graph should be close and the relations between different sub-graphs are sparse. So that we try the spectral clustering on the five matrices using two different sentiment score mechanism. \\
However, maybe because our graphs on are too sparse, the clustering doesn't really work. It will classify nearly all the roles into one single class. \\

We also do some analyze on the interact matrix. First, we use Depth-First Search to traverse the graph. Then we can get several connected sub-graphs, each of which has no connection to the others. However, in the test of \textit{Harry Potter}, this method can only rules out several unimportant supporting roles. Most of the roles are all connected in a single sub-graph.

\subsection{Relationship extraction} % Xiangyu Wei
\label{ssec:first}

Most relationships between characters in a novel is hidden in the intricate plots. That is, a human reader can easily infer that two characters A and B are friends if they took an adventure together.

{\bf Title}: Place the title centered at the top of the first page, in
a 15-point bold font. (For a complete guide to font sizes and styles,
see Table~\ref{font-table}) Long titles should be typed on two lines
without a blank line intervening. Approximately, put the title at 2.5
cm from the top of the page, followed by a blank line, then the
author's names(s), and the affiliation on the following line. Do not
use only initials for given names (middle initials are allowed). Do
not format surnames in all capitals (e.g., use ``Schlangen'' not
``SCHLANGEN'').  Do not format title and section headings in all
capitals as well except for proper names (such as ``BLEU'') that are
conventionally in all capitals.  The affiliation should contain the
author's complete address, and if possible, an electronic mail
address. Start the body of the first page 7.5 cm from the top of the
page.

The title, author names and addresses should be completely identical
to those entered to the electronical paper submission website in order
to maintain the consistency of author information among all
publications of the conference. If they are different, the publication
chairs may resolve the difference without consulting with you; so it
is in your own interest to double-check that the information is
consistent.

{\bf Abstract}: Type the abstract at the beginning of the first
column. The width of the abstract text should be smaller than the
width of the columns for the text in the body of the paper by about
0.6 cm on each side. Center the word {\bf Abstract} in a 12 point bold
font above the body of the abstract. The abstract should be a concise
summary of the general thesis and conclusions of the paper. It should
be no longer than 200 words. The abstract text should be in 10 point font.

{\bf Text}: Begin typing the main body of the text immediately after
the abstract, observing the two-column format as shown in 
the present document. Do not include page numbers.

{\bf Indent} when starting a new paragraph. Use 11 points for text and 
subsection headings, 12 points for section headings and 15 points for
the title. 

\section{Experiment}

Following ACL 2014 we will also we will attempt to automatically convert 
your \LaTeX\ source files to publish papers in machine-readable 
XML with semantic markup in the ACL Anthology, in addition to the 
traditional PDF format.  This will allow us to create, over the next 
few years, a growing corpus of scientific text for our own future research, 
and picks up on recent initiatives on converting ACL papers from earlier 
years to XML. 

We encourage you to submit a ZIP file of your \LaTeX\ sources along
with the camera-ready version of your paper. We will then convert them
to XML automatically, using the LaTeXML tool
(\url{http://dlmf.nist.gov/LaTeXML}). LaTeXML has \emph{bindings} for
a number of \LaTeX\ packages, including the ACL 2015 stylefile. These
bindings allow LaTeXML to render the commands from these packages
correctly in XML. For best results, we encourage you to use the
packages that are officially supported by LaTeXML, listed at
\url{http://dlmf.nist.gov/LaTeXML/manual/included.bindings}

\begin{table}[h]
\begin{center}
\begin{tabular}{|l|rl|}
\hline \bf Type of Text & \bf Font Size & \bf Style \\ \hline
paper title & 15 pt & bold \\
author names & 12 pt & bold \\
author affiliation & 12 pt & \\
the word ``Abstract'' & 12 pt & bold \\
section titles & 12 pt & bold \\
document text & 11 pt  &\\
captions & 11 pt & \\
abstract text & 10 pt & \\
bibliography & 10 pt & \\
footnotes & 9 pt & \\
\hline
\end{tabular}
\end{center}
\caption{\label{font-table} Font guide. }
\end{table}




%TODO: cite
\section{Discussions} % Yunhao Li
We get good results in our test overall. However, there are still some challenges needed to be faced. For the role entity recognition, it is hard to get a perfect name dictionary. We encountered situations where the several alias of the same role cannot be merged correctly. And the name prefix makes it worse. It is hard to match the "Mr. Weasley" to the one to which it truly refers. \\
For the sentiment analysis part, using polarity score is too rough and sometimes we cannot get the correct sentiment between roles. And the clustering methods doesn't work well when the Adjacency matrix is sparse. \\
For the novels like \textit{Prejudice and Discrimination}, the relation extraction works really well. But for the novels like \textit{Harry Potter and the Sorcerer's Stone}, because there are very few explicit descriptions of the social relationships in the text, the relation extraction method doesn't work as well as the former.

%TODO: cite
\section{Conclusions} % Yunhao Li
\label{sec:length}
We develop a system that could automatically mining the data of novels, including name entity recognition and merging, coreference resolution, interaction and sentiment analysis and relation extraction. And we test it on two novels, \textit{Harry Potter and the Sorcerer's Stone} and \textit{Prejudice and Discrimination}. The result shows that our system runs well.

\section*{Acknowledgments} % Yunhao Li

We really appreciate the work of Stanford NLP group. Their CoreNLP and stanfordnlp library really help a lot. We are also grateful to the researchers and developers of Spacy and NLTK, and all the authors of the papers in our references. Without their great job we cannot finish our work.

% include your own bib file like this:
\bibliographystyle{acl}
\bibliography{nlp}

\begin{thebibliography}{}

\bibitem[\protect\citename{Aho and Ullman}1972]{Aho:72}
Alfred~V. Aho and Jeffrey~D. Ullman.
\newblock 1972.
\newblock {\em The Theory of Parsing, Translation and Compiling}, volume~1.
\newblock Prentice-{Hall}, Englewood Cliffs, NJ.

\bibitem[\protect\citename{{American Psychological Association}}1983]{APA:83}
{American Psychological Association}.
\newblock 1983.
\newblock {\em Publications Manual}.
\newblock American Psychological Association, Washington, DC.

\bibitem[\protect\citename{{Association for Computing Machinery}}1983]{ACM:83}
{Association for Computing Machinery}.
\newblock 1983.
\newblock {\em Computing Reviews}, 24(11):503--512.

\bibitem[\protect\citename{Chandra \bgroup et al.\egroup }1981]{Chandra:81}
Ashok~K. Chandra, Dexter~C. Kozen, and Larry~J. Stockmeyer.
\newblock 1981.
\newblock Alternation.
\newblock {\em Journal of the Association for Computing Machinery},
  28(1):114--133.

\bibitem[\protect\citename{Gusfield}1997]{Gusfield:97}
Dan Gusfield.
\newblock 1997.
\newblock {\em Algorithms on Strings, Trees and Sequences}.
\newblock Cambridge University Press, Cambridge, UK.
\end{thebibliography}

\end{document}